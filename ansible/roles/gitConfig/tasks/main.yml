- name: add gh credentials
  shell: gh auth login --with-token 
  args:
    stdin: "{{ github_pat }}"

- name: fixup git to let us push
  shell: gh config set git_protocol https -h github.com

- name: more git fixing
  shell: gh auth setup-git

    #- name: check if gitignore exists
    #  stat:
    #    path: $HOME/.gitignore
    #  register: stat_gitignore_result
    #  
    #- name: create blank gitignore
    #  file:
    #    path: $HOME/.gitignore
    #    state: touch
    #  when: not stat_gitignore_result.stat.exists
    #
    #- name: ensure .cfg is in .gitignore
    #  lineinfile:
    #    path: $HOME/.gitignore
    #    regexp: '^\.cfg'
    #    line: .cfg

      #- name: Clone config files
      #  git: 
      #    repo: https://github.com/zachthieme/config
      #    dest: $HOME/.cfg
      #    bare: yes
      #    update: yes
      #
      #- name: Check out config files 
      #  shell: /usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME checkout -f
      #  args:
      #    chdir: $HOME
      #    executable: /usr/bin/fish
      #
      #- name: hide untracked files
      #  shell: /usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME config --local status.showUntrackedFiles no 
      #  args:
      #    chdir: $HOME
      #    executable: /usr/bin/fish

      #- name: set git upstream
      #  shell: /usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME push --set-upstream origin master

      #- name: set git email
      #  shell: /usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME config --global user.email "zach@techsage.org"
      #
      #- name: set git name
      #  shell: /usr/bin/git --git-dir=$HOME/.cfg/ --work-tree=$HOME config --global user.name "Zach Thieme"
